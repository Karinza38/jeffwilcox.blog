---
layout: post
comments: true
title: A syntax highlighting TextBlock for Silverlight 3
wordpress_id: 590
wordpress_url: http://www.jeff.wilcox.name/2010/03/syntax-highlighting-text-block/
imported_categories:
- title: c#
  slug: csharp
  autoslug: c#
- title: silverlight
  slug: silverlight
  autoslug: silverlight
imported_link_categories: []
tags: []
---
<p>I’ve adapted a syntax highlighting engine to generate a syntax highlighting TextBlock control for Silverlight. This control has built-in syntax highlighting C#, C++, JavaScript, VB.NET, XAML/XML.</p>  <p><a href="http://media.jeff.wilcox.name/blog/syntax/Syntax.zip"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="HighlightingExample" border="0" alt="HighlightingExample" src="http://waz.blob.core.windows.net/wordpress/2010/03/HighlightingExample.png" width="684" height="653" /></a> </p>  <p>In the future, once Silverlight 4 is out, I’ll of course make sure to update this to work with the rich text control to allow for copying and pasting as well, but in the meantime, this works great for <em>displaying</em> code.</p>  <h4>Based on ColorCode</h4>  <p>A while ago I was happy to see that <a href="http://blogs.msdn.com/drewmiller/">Drew Miller</a> released a simple syntax highlighting engine called <a href="http://colorcode.codeplex.com/">ColorCode</a>. It is a good implementation that moves forward through a stream, provides scoping information, and is compact enough for client use.</p>  <p>The control, however, was designed to only target ASP.NET. It writes out the results using an HtmlWriter. I had to rip out a lot of this implementation requirement that was threaded throughout the code, but what I have now effectively takes a TextBlock and outputs a bunch of Inline elements to it for all the processed code.</p>  <p>Note that I did what it took to get this control functional, this isn’t any sort of reference implementation.</p>  <h4>Download the control</h4>  <p>Here’s the source and quick sample in a Visual Studio 2010 Silverlight 3 project:</p>  <p><a href="http://media.jeff.wilcox.name/blog/syntax/Syntax.zip">[Download Zip]</a></p>  <h4>Using the control</h4>  <p>Add the control assembly to your Silverlight project. Then, add an XMLNS prefix to your Silverlight page where you’d like to use the control.</p>  <p>There are two properties of interest that should be set or bound: SourceCode (the actual source text), and SourceLanguage. The names probably could be better, sorry!</p>  <p><strong>SourceCode</strong> dependency property is the source to syntax highlight, just like the Text property of a TextBlock. The name is different to make it clear that this is not just a TextBlock control since you also need to specify the language type to colorize.</p>  <p>Since this implementation does not “auto-sense” the language, you must provide the language for interpretation. The <strong>SourceLanguage</strong> property defines this and has a value of either CSharp, Cpp, JavaScript, VisualBasic, Xaml, or Xml. It defaults to CSharp.</p>  <p>This control is small enough that I think it’ll be useful inside code sample apps. It’s 40 KB uncompressed, and 16 KB in a typical Silverlight Xap.</p>  <h4>How to get additional language support</h4>  <p>The original ASP.NET implementation on CodePlex contained support for a lot of other additional languages and file types:</p>  <ul>   <li>ASHX </li>    <li>ASAX </li>    <li>ASPX </li>    <li>ASPX.CS </li>    <li>ASPX.VB </li>    <li>HTML </li>    <li>SQL </li>    <li>PHP </li>    <li>CSS </li> </ul>  <p>To add any of these to your control, you just need to:</p>  <ol>   <li>Add the language name to the SourceLanguageType enum, and plumb its value through the control (sorry for the pain in this step) </li>    <li>Add the ILanguage file to the control inside the Compilation\Languages\ folder </li>    <li>Make sure that the language is also in Languages.cs. Note that I’ve kept all the original CodePlex-provided values inside this file to make it easy to add them back. </li> </ol>  <p>Hope this helps.</p>
